{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} | {{ title }}{% endblock %}

{% block body %}

    {% set user = article.author %}
    <section id="showArticle">
        {{include('partials/_navbarMenu.html.twig')}}
    
        <div class="container-fluid wrapper">
            <div class="row col-xs-12 col-md-10" id="wrapArticleContent">
                
                    <div class="banner">
                        <img src="{{asset('uploads/banner/' ~ user.banner)}}" alt="">
                        <div class="user">
                            <div class="avatar">
                                {% if user.avatar is not null %}
                                    <img src="{{asset('/uploads/avatar/'~ user.avatar)}}" alt="avatar" class="img-fluid"/>
                                {% else %}
                                    <img src="{{asset('/img/avatar-1.png')}}" alt="avatar" class="img-fluid"/>
                                {% endif %}            
                                </div>
                                    {# todo: faire un profil public #}
                                    <h2><a href="#">{{user.nickname}}</a> </h2>
                        </div>
                    </div>
                    
           
                <div class="col-md-8">
                    {% if article.video %}
                        {# video affichée #}
                        {% include "/partials/_video.html.twig" %}
                    {% else %}
                        {#TODO mettre image d'illustration si il y en a,  ou mettre une image par defaut #}
                        <img src="{{asset('/img/blogDefault.png')}}" alt="image d'illustration par défaut" class="img-fluid">
                    {% endif %}
                    <div class="mt-3">
                        <h2>{{article.title}}</h2>  
                        <p class="pe-4">{{article.content|raw}}</p>
                    </div>
                    {# TODO:prevoir place pour images #}
                    {# TODO:prevoir place pour commentaires/réponses #}

                    
                </div>
                <div class="col-md-4">
                {# articles du même auteur : TODO boucle pour les articles #}
                    <div class="row g-4" id="wrapSameAuthorArticle">
                    {% for article in articles %}
                            <div class="col-md-6">
                                <div class="card">
                                    {% if article.video %}
                                        <img src="{{asset('uploads/article/video/thumb/'~ article.video.thumbnail)}}" class="card-img-top" alt="Vignette de l'article {{article.title}} de {{article.author}}">
                                    {% else %}
                                        <img src="{{asset('/img/BlogDefault.png')}}" class="card-img-top" alt="Vignette par défaut de l'article de {{article.author}}">
                                    {% endif %}
                                    <div class="card-body">
                                        <h5 class="card-title">{{article.title}}</h5>
                                        <p class="card-text">{{article.content|u.truncate(60, '...')}}</p>
                                    </div>
                                </div>
                            </div>  
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>

    </section>
{% endblock %}

{# PLYR #}
{% block stylesheets %}  
        <link rel="stylesheet" href="https://cdn.plyr.io/3.7.2/plyr.css" />
{% endblock %}

{% block javascripts %}
    <script>

        import Plyr from 'plyr';
        const player = new Plyr('#player');

        <script src="https://cdn.plyr.io/3.7.2/plyr.js"></script>

    </script>
{% endblock %}