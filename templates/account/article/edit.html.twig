{% extends 'base.html.twig' %}

{% block title %}{{ parent() }} | {{ title }}{% endblock %}

{% block body %}
 
    <section id="editArticle">
      
            {{include('partials/_navbarMenu.html.twig')}}

       
        <div class="container-fluid wrapper">
            <div>
                {{include('partials/_sidebarMenuProfile.html.twig')}}  
            </div>
            
            <div class="row">
                <div class="mb-3"> 
                    <h3>Modification de l'article <i>"{{article.title}}"</i> </h3>
                </div>    
                <div class="col-md-6 col-sm-12">
                    <h5><i class="fa-solid fa-pen"></i> Contenu de l'article</h5>
                    {{form_start(form)}}
                        {{form_row(form.title)}}
                        {{form_row(form.content)}}   
                </div>
               
                <div class="col-md-6 col-sm-12">
                    <h5><i class="fa-solid fa-film"></i> Ajouter ou modifier une vid√©o</h5>
                        {{form_row(form.video.title)}}
                        {{form_row(form.video.source)}}
                                           
                    <h5 class="mt-3"><i class="fa-solid fa-images"></i> Ajouter ou supprimer des images</h5>
                       
                    <div class="images"
                        data-index="{{ form.images|length > 0 ? form.images|last.vars.name + 1 : 0 }}"
                        data-prototype="{{ form_row(form.images.vars.prototype)|e('html_attr') }}"> 

                    {% for image in form.images %}
                         {{form_row(image.source)}}
                         {{form_row(image.caption)}}
                    {% endfor %}
                    </div> 
                    
                   
                </div> 
                    <div>
                        <a href="{{path('account_articles')}}" class="btn btn-dark btn-lg"><i class="fa-solid fa-chevron-left"></i> Retour</a>
                        <button type="submit" class="btn btn-warning btn-lg m-3">Modifier</button>
                    </div>
                    
                    {{form_end(form)}}
            </div>
                
        </div>
 
    </section>
{% endblock %}



{% block javascripts %}
    <script>

        const addImgLink = document.createElement('button')
            addImgLink.classList.add('add_image_list','btn','btn-dark','my-3')
            addImgLink.innerText='Ajouter une image'
            addImgLink.dataset.collectionHolderClass='images'
    
        
            const collectionHolder = document.querySelector('div.images')
            collectionHolder.appendChild(addImgLink)

            const addFormToCollection = (e) => {
                const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

                const item = document.createElement('div');
                
                const separator = document.createElement('hr');
                separator.classList.add('my-4');


                item.innerHTML = collectionHolder
                    .dataset
                    .prototype
                    .replace(
                    /__name__/g,
                    collectionHolder.dataset.index
                    );

                collectionHolder.appendChild(item);
                collectionHolder.appendChild(separator);

                collectionHolder.dataset.index++;
            }

            addImgLink.addEventListener("click", addFormToCollection)

        </script>
{% endblock %}




